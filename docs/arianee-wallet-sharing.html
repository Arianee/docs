<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Arianee Wallet Sharing · Arianee Docs</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="***Still in BETA***"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Arianee Wallet Sharing · Arianee Docs"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.arianee.org/"/><meta property="og:description" content="***Still in BETA***"/><meta property="og:image" content="https://docs.arianee.org/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://docs.arianee.org/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-112469684-3', 'auto');
              ga('send', 'pageview');
            </script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.png" alt="Arianee Docs"/><h2 class="headerTitleWithLogo">Arianee Docs</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><li class=""><a href="https://arianee.org" target="_self">Arianee Home</a></li><li class=""><a href="https://github.com/arianee" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Standards</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-project">Arianee Project</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-economy">Arianee Economy</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-decentralized">Arianee Decentralized Platform</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Key Features<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/arianee-key-features-intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-creation">Create a Passport</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-transfer">Transfer a Passport</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-proof-of-ownership">Prove ownership</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-message">Send Message to Passport</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-event">Link Event to Passport</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-history">Access Passport History</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-update">Update a Passport</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/how-to-proceed">How to proceed</a></li><li class="navListItem"><a class="navItem" href="/docs/kyb-process">KYB Process</a></li><li class="navListItem"><a class="navItem" href="/docs/staking-policy">Staking policy</a></li><li class="navListItem"><a class="navItem" href="/docs/livedemo">Live Demo</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">SDK<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/arianee-js">ArianeeJS library</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-wallet">Wallet</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-economy">Economy</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-certificate">Certificate</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-identity">Identity</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-messaging">Messaging</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-js-event">ArianeeEvent</a></li><li class="navListItem"><a class="navItem" href="/docs/events-listener">Events Listener</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-privacy-gateway">Arianee Privacy Gateway</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Standards<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/standard-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/arianee-links">Arianee Links</a></li><li class="navListItem"><a class="navItem" href="/docs/ArianeeProductCertificate-i18n">Arianee Certificate Schema</a></li><li class="navListItem"><a class="navItem" href="/docs/ArianeeBrandIdentity-i18n">Arianee Identity Schema</a></li><li class="navListItem"><a class="navItem" href="/docs/ArianeeEvent-i18n">Arianee Event Schema</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/arianee-wallet-sharing">Arianee Wallet Sharing (BETA)</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Smart Contracts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/testnet">Arianee Testnet</a></li><li class="navListItem"><a class="navItem" href="/docs/mainnet">Arianee Mainnet</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Mobile App<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/mobile-app-guidelines">Guidelines</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/Arianee/docs/tree/master/docs/arianee-wallet-sharing.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Arianee Wallet Sharing</h1></header><article><div><span><p><strong><em>Still in BETA</em></strong></p>
<p>To increase user adoption and provide a smoother user experience, Arianee designed a standard to share the same wallet across multiple mobile applications.</p>
<p>This standard defines how a mobile application can check if another Arianee compatible application is installed on the device  and, if so, import the main wallet used for this other application. This avoids creating multiple wallets for the same user.</p>
<h2><a class="anchor" aria-hidden="true" id="workflow"></a><a href="#workflow" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Workflow</h2>
<p>The workflow starts with two Arianee compatible applications:</p>
<p>The first (App#1) that will import the wallet from the other mobile application</p>
<p>The second (App#2) with an already initialized wallet</p>
<ul>
<li>User launches App#1</li>
<li>App#1 detects if App#2 is installed on the device</li>
<li>The user confirms his/her desire to import the wallet from App#2 to App#1</li>
<li>App#1 forges an Arianee Sharing Wallet request and redirects the user to App#2 (with a one-time public key, for privacy reasons)</li>
<li>App#2 receives the Arianee Sharing Wallet request, including App#1 scheme and the one-time public key</li>
<li>App#2 confirms if App#1 scheme exists in the list of verified Brand Identities</li>
<li>The user confirms his/her desire to export the wallet to App#1</li>
<li>App#2 encrypts the wallet with the one-time public key and redirects the user to App#1</li>
<li>App#1 receives a deeplink with the encrypted wallet</li>
<li>App#1 decrypts and import the wallet</li>
<li>Done !</li>
</ul>
<p>An open source <a href="https://github.com/Arianee/apkss-example/" target="_blank" rel="nofollow noreferrer noopener">exemple ionic app</a> is available for more details. This application implements the whole Arianee Wallet Sharing process.</p>
<h2><a class="anchor" aria-hidden="true" id="about-mobile-app-schemes"></a><a href="#about-mobile-app-schemes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About &quot;mobile app schemes&quot;</h2>
<p>In order to avoid rogue applications to request access to the wallet stored in an Arianee compatible application, or the other way around, the Arianee wallet sharing must be done between applications with a &quot;mobile app scheme&quot; backed by a verified Brand.</p>
<p>To be verified by the Arianee project a Brand must go through a <a href="kyb-process">Know your business (KYB) process</a> leading to its Brand Identity registration on the Arianee Identity smart contract. Any verified Brand can then store a &quot;mobile app scheme&quot; in the content (JSON file) of its Brand Identity. The &quot;mobile app scheme&quot; is a unique identifier created when a mobile application is released on an app store (Google &amp; Apple).</p>
<p>In short, when developing a mobile application, <strong>a requirement for the Arianee wallet sharing to work is that the &quot;mobile app scheme&quot; of App#1 and App#2 are stored in verified Brand identities</strong>. Two &quot;mobile app schemes&quot; can be stored in the content (JSON file) of a Brand identity:</p>
<ul>
<li>iosScheme for iOS</li>
<li>androidScheme for Android</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="how-to-detect-a-compatible-wallet-application-"></a><a href="#how-to-detect-a-compatible-wallet-application-" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to detect a compatible wallet application ?</h2>
<p><strong><em>First, App#1 needs to check if a compatible wallet application is installed on the user device and, if so, it should propose to import the main wallet from this compatible wallet application</em></strong></p>
<ol>
<li>App#1 retrieves the list of &quot;mobile app schemes&quot; backed by verified Brands</li>
</ol>
<blockquote>
<p>You can have the whole list in a centralized way :
<a href="https://api.arianee.org/report/apkss/identities" target="_blank" rel="nofollow noreferrer noopener">https://api.arianee.org/report/apkss/identities</a></p>
</blockquote>
<pre><code class="hljs">[{
<span class="hljs-symbol">    name:</span> <span class="hljs-string">"Arianee"</span>,
<span class="hljs-symbol">    iosScheme:</span> <span class="hljs-string">"com.arianee.wallet"</span>,
<span class="hljs-symbol">    androidScheme:</span> <span class="hljs-string">"com.arianee.wallet"</span>,
<span class="hljs-symbol">    address:</span> <span class="hljs-string">"0xb908B66915ecD1ec31e669adc9C71BDcE44EC601"</span>,
<span class="hljs-symbol">    identityId:</span> <span class="hljs-string">"0xb908B6"</span>,
<span class="hljs-symbol">    appName:</span> <span class="hljs-string">"Arianee Wallet"</span>
}]
</code></pre>
<ol start="2">
<li>App#1 detects mobile applications installed on the user device and with a &quot;mobile app scheme&quot; backed by verified Brand</li>
</ol>
<blockquote>
<p><a href="https://www.npmjs.com/package/cordova-plugin-appavailability" target="_blank" rel="nofollow noreferrer noopener">cordova-plugin-appavailability</a> is a cordova plugin to check if an app is installed on the device</p>
</blockquote>
<ol start="3">
<li><p>The user chooses the app (App#2) to import the wallet from</p></li>
<li><p>App#1 double checks the &quot;mobile app scheme&quot; of App#2 in Arianee identity</p></li>
</ol>
<blockquote>
<p>Check <a href="/docs/arianee-js-identity#read-identity-using-shortcode">read-identity-using-shortcode</a></p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="how-to-forge-an-arianee-sharing-wallet-request-"></a><a href="#how-to-forge-an-arianee-sharing-wallet-request-" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to forge an Arianee Sharing Wallet request ?</h2>
<p><strong><em>Second, App#1 needs to forge a link that will open App#2 and carry all the mandatory information to pursue the process.</em></strong></p>
<ol>
<li>App#1 creates a key pair (PrivateOneTimeKey &amp; PublicOneTimeKey) to encrypt/decrypt the wallet between App#1 and App#2. (see <a href="#encrypt">About encryption</a> for more details)</li>
</ol>
<pre><code class="hljs">    encryptAlgorithm = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'RSA-OAEP'</span>,
        <span class="hljs-attr">modulusLength</span>: <span class="hljs-number">4096</span>,
        <span class="hljs-attr">publicExponent</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>([<span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>]),
        <span class="hljs-attr">hash</span>: <span class="hljs-string">'sha-512'</span>
    };
    <span class="hljs-keyword">const</span> keyUsages = [<span class="hljs-string">'encrypt'</span>, <span class="hljs-string">'decrypt'</span>];
    <span class="hljs-keyword">const</span> keys = <span class="hljs-keyword">await</span> crypto.subtle.generateKey(<span class="hljs-keyword">this</span>.encryptAlgorithm, <span class="hljs-literal">true</span>, keyUsages);
    <span class="hljs-keyword">const</span> privateKey = <span class="hljs-keyword">await</span> crypto.subtle.exportKey(<span class="hljs-string">'jwk'</span>, keys.privateKey);
    <span class="hljs-keyword">const</span> publicKey = <span class="hljs-keyword">await</span> crypto.subtle.exportKey(<span class="hljs-string">'jwk'</span>, keys.publicKey);
</code></pre>
<blockquote>
<p>Please note the keys should use a JSON Web Key as defined in <a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="nofollow noreferrer noopener">RFC7517</a>.</p>
<p>Please note the Arianee ecosystem only handles this algorithm for now</p>
</blockquote>
<ol start="2">
<li><p>App#1 stores the key pair (PrivateOneTimeKey &amp; PublicOneTimeKey) somewhere safe (check secure storage for more details - documentation ongoing)</p></li>
<li><p>App#1 forges the following deeplink and it redirects the user with this deeplink :</p></li>
</ol>
<pre><code class="hljs"><span class="hljs-keyword">let</span> deeplink = scheme + <span class="hljs-string">'://apkssRequest?requestId=0x135935&amp;publicKey='</span> + <span class="hljs-built_in">JSON</span>.stringify(publicKey)
</code></pre>
<blockquote>
<ul>
<li>Scheme : &quot;mobile app scheme&quot; of the requested App#2</li>
<li>Route : apkssRequest</li>
<li>QueryParams:</li>
<li>requestId: The Brand identity ID of the Brand Identity backing App#1</li>
<li>publicKey : PublicOneTimeKey (formated with the JSON Web Key as defined in <a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="nofollow noreferrer noopener">RFC7517</a>)</li>
</ul>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="how-to-handle-an-arianee-wallet-sharing-request-"></a><a href="#how-to-handle-an-arianee-wallet-sharing-request-" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to handle an Arianee Wallet Sharing request ?</h2>
<p><strong><em>Next, App#2 needs to handle the Arianee Wallet Sharing request and it should return an Arianee Wallet Sharing response. Since App#1 might be App#2 in some other cases, All mobile applications should be able to handle an Arianee Wallet Sharing request.</em></strong></p>
<ol>
<li><p>App#2 needs to handle <strong><em>apkssRequest</em></strong> route.</p></li>
<li><p>App#2 checks if <strong><em>requestId</em></strong> QueryParam matches the Brand identity schema using getIdentity</p></li>
</ol>
<blockquote>
<p>Check <a href="/docs/arianee-js-identity#read-identity-using-shortcode">read-identity-using-shortcode</a></p>
</blockquote>
<ol start="3">
<li><p>App#2 should ask user's permission to share its main wallet with App#1</p></li>
<li><p>App#2 encrypts the mnemonic of its main wallet with the <strong><em>publickey</em></strong> (PublicOneTimeKey)</p></li>
</ol>
<pre><code class="hljs"><span class="hljs-keyword">const</span> algorithm = {
        name:<span class="hljs-string">"RSA-OAEP"</span>,
        hash: <span class="hljs-string">"SHA-512"</span>
      };

<span class="hljs-keyword">const</span> publicKey = <span class="hljs-keyword">await</span> crypto.subtle.importKey(
    <span class="hljs-string">'jwk'</span>,
    jwk,
    algorithm,
    <span class="hljs-literal">true</span>,
    jwk.key_ops
);
<span class="hljs-keyword">const</span> enc = <span class="hljs-keyword">new</span> TextEncoder()
<span class="hljs-keyword">const</span> encryptedMnemonics = <span class="hljs-keyword">await</span> crypto.subtle.encrypt(algorithm, publicKey, enc.encode(mnemonic));
</code></pre>
<p>Please note the publickey (PublicOneTimeKey) should use a JSON Web Key as defined in <a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="nofollow noreferrer noopener">RFC7517</a>.</p>
<ol start="5">
<li><p>App#2 forges the Arianee Wallet Sharing response deeplink with encrypted mnemonic</p>
<pre><code class="hljs"><span class="hljs-keyword">const</span> encryptedMnemonicsBuffer = <span class="hljs-keyword">new</span> Buffer(encryptedMnemonics)
<span class="hljs-keyword">let</span> deeplink = Scheme +<span class="hljs-string">'://apkssResponse?encryptedMnemonics='</span>+<span class="hljs-built_in">JSON</span>.stringify(objectLink.encryptedMnemonics)
</code></pre>
<blockquote>
<ul>
<li>Scheme : &quot;mobile app scheme&quot; of the requesting App#1, can be found with getIdentity from the requestId</li>
<li>Route : apkssResponse</li>
<li>QueryParams:</li>
<li>encryptedMnemonics : the encrypted mnemonic in buffer</li>
</ul>
</blockquote></li>
<li><p>App#2 redirects the user with this deeplink</p></li>
</ol>
<h2><a class="anchor" aria-hidden="true" id="how-to-handle-an-arianee-wallet-sharing-response-"></a><a href="#how-to-handle-an-arianee-wallet-sharing-response-" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How to handle an Arianee Wallet Sharing response ?</h2>
<p><strong><em>Last, App#1 needs to handle the Arianee Wallet Sharing response deeplink and import the wallet from App#2</em></strong></p>
<ol>
<li><p>App#1 needs to handle <strong><em>apkssResponse</em></strong> route</p></li>
<li><p>App#1 should ask user's permission to import the main wallet of App#2</p></li>
<li><p>App#1 decrypts the <strong><em>encryptedMnemonics</em></strong> QueryParam using the key pair (PrivateOneTimeKey &amp; PublicOneTimeKey) it created and stored earlier</p></li>
</ol>
<pre><code class="hljs">    <span class="hljs-keyword">const</span> privateKeyCrypt = <span class="hljs-keyword">await</span> crypto.subtle.importKey(<span class="hljs-string">'jwk'</span>, privateKey, <span class="hljs-keyword">this</span>.encryptAlgorithm, <span class="hljs-literal">true</span>, [<span class="hljs-string">'decrypt'</span>]);

    <span class="hljs-keyword">const</span> encryptedMnemonicArray = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(encryptedMnemonics.length);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; encryptedMnemonics.length; i++) {
      encryptedMnemonicArray[i] = encryptedMnemonics[i];
    }

    <span class="hljs-keyword">const</span> decrypt = <span class="hljs-keyword">await</span> crypto.subtle.decrypt(<span class="hljs-keyword">this</span>.encryptAlgorithm, privateKeyCrypt, encryptedMnemonicArray);
    <span class="hljs-keyword">const</span> mnemonic = <span class="hljs-keyword">new</span> TextDecoder().decode(decrypt);
</code></pre>
<p>Please note the privatekey (PrivateOneTimeKey) should use a JSON Web Key as defined in <a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="nofollow noreferrer noopener">RFC7517</a>.</p>
<ol start="4">
<li>App#1 imports the main wallet of App#2</li>
</ol>
<pre><code class="hljs">wallet.from<span class="hljs-constructor">Mnemonic(<span class="hljs-params">mnemonic</span>)</span>;
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="about-encryption-a-idencrypta"></a><a href="#about-encryption-a-idencrypta" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About encryption <a id="encrypt"></a></h2>
<p>Interoperability across mobile applications is essential for the Arianee protocol adoption and using the same encryption system is a good beginning to support interoperability.</p>
<p>The encryption system used is compatible with the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API" target="_blank" rel="nofollow noreferrer noopener">Web Crypto API</a>:</p>
<ul>
<li>Algorithm: RSA-OAEP</li>
<li>Hash: sha-512</li>
<li>Key length: 4096</li>
</ul>
<p>Please note the algorithm used  will evolve over time. You must integrate the latest algorithm to ensure compatibility with other mobile applications.</p>
<p>Also, to communicate correctly the keys should use a JSON Web Key as defined in <a href="https://tools.ietf.org/html/rfc7517" target="_blank" rel="nofollow noreferrer noopener">RFC7517</a>.</p>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 5/13/2020</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/ArianeeMessage-i18n"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/docs/testnet"><span>Arianee Testnet</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#workflow">Workflow</a></li><li><a href="#about-mobile-app-schemes">About &quot;mobile app schemes&quot;</a></li><li><a href="#how-to-detect-a-compatible-wallet-application-">How to detect a compatible wallet application ?</a></li><li><a href="#how-to-forge-an-arianee-sharing-wallet-request-">How to forge an Arianee Sharing Wallet request ?</a></li><li><a href="#how-to-handle-an-arianee-wallet-sharing-request-">How to handle an Arianee Wallet Sharing request ?</a></li><li><a href="#how-to-handle-an-arianee-wallet-sharing-response-">How to handle an Arianee Wallet Sharing response ?</a></li><li><a href="#about-encryption-a-idencrypta">About encryption <a id="encrypt"></a></a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"></a><div><h5>Docs</h5><a href="/docs/intro">Overview</a><a href="/docs/howToProceed">Getting started</a><a href="/docs/ArianeeJS">ArianeeJS SDK Reference</a></div><div><h5>Community</h5><a href="https://t.me/arianeeproject" target="_blank">Telegram</a><div class="social"><a href="https://twitter.com/ArianeeProject" class="twitter-follow-button">Follow @ArianeeProject</a></div></div><div><h5>More</h5><a href="https://github.com/Arianee">GitHub</a></div></section><section class="copyright">Copyright © 2023 .Arianee Project <br/>Association subject to the Law of 1 July 1901 and the Decree of 16 August 1901 <br/> Siret Number 852 836 105 00019 – APE 9499Z</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'e73e0f88578cab4470c13f065abb38bb',
                indexName: 'arianee',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>